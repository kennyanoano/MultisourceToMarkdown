# MultiSourceMDについて

MultiSourceMDは、HTML、PDF、TXT、docx、mel、py、xlsx、xmlなどの複数のソースフォーマットからMarkdown(MD)形式への変換をサポートするツールです。このツールを使用することで、MDファイルをZIP形式で圧縮し、AIモデルなどに提供する資料を簡単に作成できます。また、生成されたMDファイルの後処理ルールを設定し、不要な内容を削除することができます。

## 対応フォーマット

- https～（一部のみ）
- HTML
- PDF
- TXT
- docx
- mel
- py
- xlsx
- xml
- https-Confluence (初回のみ、認証用のメアド/APIキー/ドメイン名が必要/入力後再起動が必要)
- https-Jira (初回のみ、認証用のメアド/APIキー/ドメイン名が必要/入力後再起動が必要)

## セットアップ方法

1. Pythonがシステムにインストールされていることを確認してください。
2. リポジトリをローカルマシンにクローンします。
3. プロジェクトディレクトリで`pip install -r requirements.txt`を実行し、必要な依存関係をインストールします。

## 使用方法

MultiSourceToMakdown.batを実行

## 主な機能

- **ソースの追加と編集**: ソース（HTML、PDF、TXTファイルまたはURL）を追加し、必要に応じて編集できます。追加はセルに記入して追加する方法と、ファイルをドラッグアンドドロップする方法があります。リストから選択すると編集モードになります。
- **変換**: 追加したソースをMarkdown形式に変換します。選択して個別変換、選択をしない状態だと全変換。
- **クレンジングルールの管理**: 変換前にテキストをクリーニングするためのルールを追加、編集、適用できます。

## クレンジング処理

- **ルールの追加**: 「Cleansing Rules」ボタンをクリックしてウィンドウを開き、「Add Rule」ボタンをクリックして新しいルールを追加します。
- **ルールの適用**: ルールタイプ、条件、アクションを入力し、「Apply ALL」ボタンをクリックしてルールを適用します。選択して実行でルールが一つ適用、何も選択しないとルール適用です。
フォルダに大してクレンジングしたいときは Tab1-3を押してください

## クレンジング機能紹介

- `replace`: 特定の文字列を別の文字列に置換します。変換したい文字を一つ目の欄に、変換後の文字を二つ目の欄に入れます
- `remove_whitespace`: 余分な空白を削除します。欄への記入は不要
- `remove_tag`: 指定されたタグとその内容を削除します。
- `remove_before`: 指定された文字列より前を削除します。一つ目の欄に文字列を記入し二つ目の欄は空欄でＯＫ
- `remove_after`: 指定された文字列より後を削除します。一つ目の欄に文字列を記入し二つ目の欄は空欄でＯＫ
- `remove_until_newline`: 指定された文字列が見つかったらそこから改行までを削除します。一つ目の欄に文字列を記入し二つ目の欄は空欄でＯＫ

## タブ機能

MultiSourceMDでは、複数のソースを管理するためにタブを使用します。各タブは異なるソースグループを表し、整理と変換プロセスを簡単にします。

## 改造したいとき

- **変換フォーマットの追加**: `KAno_convert_script.py`を修正し、`format_to_md.py`を追加します。
- **クレンジングルールの追加**: `cleansing_rules.py`を修正します。
- コンフルエンスを認証なしで使うならif "atlassian.net/～をコメントアウト

## セキュリティに関する注意

APIキー、ユーザー名、ドメイン名などの認証情報は、MultiSourceMDの機能を利用する上で必要な情報です。これらの情報は、外部のサービスへのアクセスに使用されます。ユーザーは、これらの情報を安全に管理し、不正アクセスから保護する責任があります。

- **環境変数の使用**: 認証情報は、環境変数としてシステムに保存されます。これにより、スクリプト内で直接認証情報を扱う必要がなくなり、セキュリティリスクを軽減できます。
- **セキュアな保存**: 環境変数に保存される認証情報は、システムのセキュリティ設定に依存します。ユーザーは、自身のシステムが適切に保護されていることを確認し、不正アクセスや情報漏洩のリスクを最小限に抑える必要があります。
- **注意喚起**: 認証情報の取り扱いには十分注意してください。特に、公共の場や他人と共有するコンピューター上での使用は避け、認証情報が第三者に知られることのないようにしてください。


## やりたいこと

- インターネットのサイトでうまく読み込めないものに対応する。

[Read this in English](README_en.md)